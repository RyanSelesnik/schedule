#!/bin/bash
# Study CLI - Quick access to study tracker
# Usage: study <command> [args]

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
TRACKER="$SCRIPT_DIR/update_tracker.py"

case "$1" in
    # Tracker commands
    status|s)
        python "$TRACKER" status
        ;;
    courses|c)
        python "$TRACKER" courses
        ;;
    next|n)
        python "$TRACKER" next
        ;;
    update|u)
        shift
        python "$TRACKER" update "$@"
        ;;
    score)
        shift
        python "$TRACKER" score "$@"
        ;;
    hours|h)
        shift
        python "$TRACKER" hours "$@"
        ;;
    partner)
        shift
        python "$TRACKER" partner "$@"
        ;;
    paper)
        shift
        python "$TRACKER" paper "$@"
        ;;

    # Git sync commands
    sync)
        shift
        "$SCRIPT_DIR/sync.sh" "$@"
        ;;
    pull)
        cd "$SCRIPT_DIR/.." && git pull
        ;;

    # Calendar commands
    alerts)
        "$SCRIPT_DIR/add_alerts.sh"
        ;;

    # Help
    help|--help|-h|"")
        cat << 'EOF'
Study CLI - Manage your study schedule

USAGE: study <command> [args]

TRACKER COMMANDS:
    status,   s              Show all assessment statuses
    courses,  c              List course codes and assessment keys
    next,     n              Show upcoming deadlines
    update,   u <course> <assessment> <status>
                             Update assessment status
    score       <course> <assessment> <score>
                             Record a score
    hours,    h <hours>      Log study hours
    partner     <name>       Set CV&PR coursework partner
    paper       <title>      Set Dist.Optim paper topic

GIT COMMANDS:
    sync      [message]      Commit and push all changes
    pull                     Pull latest changes

CALENDAR:
    alerts                   Add notification alerts to deadlines

COURSE CODES:
    pc = Predictive Control
    do = Distributed Optimisation
    cv = Computer Vision & PR
    ao = Applied Advanced Optimisation

EXAMPLES:
    study next
    study status
    study u pc basic_part_2 submitted
    study u do ps1 completed
    study score cv pr_coursework 85
    study h 2.5
    study sync "Finished PS1"
EOF
        ;;
    *)
        echo "Unknown command: $1"
        echo "Run 'study help' for usage"
        exit 1
        ;;
esac
